<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function suggests that a company in your loanbook is the same as a
company in the tilt dataset when the similarity between their names meets
all of these conditions:
It's the highest among all other candidates.
It's above the value set in the argument suggestion_threshold.
It's the only such highest value in the group defined by a combination of
company_name x postcode -- to avoid duplicates.

"><title>Suggest matching companies in a loanbook and tilt datasets — suggest_match • tilt.company.match</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Suggest matching companies in a loanbook and tilt datasets — suggest_match"><meta property="og:description" content="This function suggests that a company in your loanbook is the same as a
company in the tilt dataset when the similarity between their names meets
all of these conditions:
It's the highest among all other candidates.
It's above the value set in the argument suggestion_threshold.
It's the only such highest value in the group defined by a combination of
company_name x postcode -- to avoid duplicates.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tilt.company.match</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tilt-company-match.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/README_code.html">README (code)</a>
    <a class="dropdown-item" href="../articles/coverage.html">Calculate coverage statistics</a>
    <a class="dropdown-item" href="../articles/handling-large-loanbook.html">Handling a large loanbook</a>
    <a class="dropdown-item" href="../articles/standalone.html">Standalone (code)</a>
    <a class="dropdown-item" href="../articles/tilt-company-match_code.html">Get started (code)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Suggest matching companies in a <code>loanbook</code> and <code>tilt</code> datasets</h1>
      
      <div class="d-none name"><code>suggest_match.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function suggests that a company in your <code>loanbook</code> is the same as a
company in the <code>tilt</code> dataset when the <code>similarity</code> between their names meets
all of these conditions:</p><ul><li><p>It's the highest among all other candidates.</p></li>
<li><p>It's above the value set in the argument <code>suggestion_threshold</code>.</p></li>
<li><p>It's the only such highest value in the group defined by a combination of
<code>company_name</code> x <code>postcode</code> -- to avoid duplicates.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">suggest_match</span><span class="op">(</span></span>
<span>  <span class="va">loanbook</span>,</span>
<span>  <span class="va">tilt</span>,</span>
<span>  eligibility_threshold <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  suggestion_threshold <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>loanbook</dt>
<dd><p>A <code>loanbook</code> dataframe like <a href="demo_loanbook.html">demo_loanbook</a>.</p></dd>


<dt>tilt</dt>
<dd><p>A <code>tilt</code> dataframe like <a href="demo_tilt.html">demo_tilt</a>.</p></dd>


<dt>eligibility_threshold</dt>
<dd><p>Minimum value of <code>similarity</code> to keep a
candidate match. Values under it are most likely false positives and thus
dropped. This drastically reduce the number of candidates you'll need to
validate manually. We believe this benefit outweighs the potential loss of
a few true positives.</p></dd>


<dt>suggestion_threshold</dt>
<dd><p>Value of <code>similarity</code> above which a match may be
suggested.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A dataframe with:</p><ul><li><p>All the columns from the <code>loanbook</code> dataset.</p></li>
<li><p>All the columns from the <code>tilt</code> dataset butthe columns
<code>id</code>, <code>company_name</code>, <code>postcode</code> and <code>country</code> all get the suffix "_tilt".</p></li>
<li><p>New columns:</p><ul><li><p><code>company_alias</code></p></li>
<li><p><code>company_alias_tilt</code></p></li>
<li><p><code>similarity</code></p></li>
<li><p><code>suggest_match</code></p></li>
<li><p><code>accept_match</code>.
For each company in the <code>loanbook</code> matching candidates are arranged by
descending <code>similarity</code>.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates the similarity between a standardized alias of the
<code>company_name</code> from the <code>loanbook</code> and <code>tilt</code> datasets. The standardized
alias makes real matches more likely by applying common best practices in
names matching. Complete similarity corresponds to <code>1</code>, and complete
dissimilarity corresponds to <code>0</code>.</p>
<p>The columns <code>postcode</code> and <code>country</code> affect the quality of the matches and
the amount of manual-validation work ahead:</p><ul><li><p>If your <code>loanbook</code> has both <code>postcode</code> and <code>country</code> we match companies in
that specific <code>postcode</code> and that specific <code>country</code>. You will likely match
companies that are really the same (true positives) because it's unlikely
that two companies with similar name will be located close to each other.
This will cost you the minimum amount of manual-validation work ahead.</p></li>
<li><p>If your <code>loanbook</code> lacks <code>postcode</code> but has <code>country</code> we match companies in
that specific <code>country</code> but across every <code>postcode</code>. You will possibly match
companies that are not really the same (false positives) but happen to have a
similar name and are located in the same <code>country</code>. This will cost you
additional manual-validation work ahead.</p></li>
<li><p>If your <code>loanbook</code> has <code>postcode</code> but lacks <code>country</code> we match companies with
the same <code>postcode</code> but  across every <code>country</code>. You will possibly match
companies that are not really the same (false positives) but happen to have a
similar name and the same
postcode. This will cost you additional manual-validation work ahead.</p></li>
<li><p>If your <code>loanbook</code> lacks both <code>postcode</code> and <code>country</code> we match companies
across the entire dataset.  You will most likely match companies that are not
really the same (false positives). This will cost you the greatest amount of
additional manual-validation work ahead.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vroom.r-lib.org" class="external-link">vroom</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">loanbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html" class="external-link">vroom</a></span><span class="op">(</span><span class="fu"><a href="example_file.html">example_file</a></span><span class="op">(</span><span class="st">"demo_loanbook.csv"</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tilt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html" class="external-link">vroom</a></span><span class="op">(</span><span class="fu"><a href="example_file.html">example_file</a></span><span class="op">(</span><span class="st">"demo_tilt.csv"</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">suggest_match</span><span class="op">(</span><span class="va">loanbook</span>, <span class="va">tilt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 18 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       id compa…¹ postc…² country misc_…³ compa…⁴ id_tilt compa…⁵ misc_…⁶ compa…⁷</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Peasan… 01234   germany A       peasan…       1 Peasan… A       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Peasan… 01234   germany A       peasan…       2 Peasan… Z       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     1 Peasan… 01234   germany A       peasan…       4 Peasan… B       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     2 Peasan… 01234   germany Z       peasan…       1 Peasan… A       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     2 Peasan… 01234   germany Z       peasan…       2 Peasan… Z       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     2 Peasan… 01234   germany Z       peasan…       4 Peasan… B       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     3 Peasan… 11234   germany Z       peasan…       3 Peasan… Z       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     4 Peasan… 01234   germany Z       peasan…       4 Peasan… B       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     4 Peasan… 01234   germany Z       peasan…       1 Peasan… A       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     4 Peasan… 01234   germany Z       peasan…       2 Peasan… Z       peasan…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span>     5 Bread … 23456   germany C       breadb…       5 The Br… C       thebre…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span>     6 Flower… 34567   germany Z       flower…       7 Flower… F       flower…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span>     6 Flower… 34567   germany Z       flower…       6 Flower… D       flower…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span>     7 Screwd… 45678   germany D       screwd…      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span>     8 Screwd… 45678   germany Z       screwd…      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span>     9 John M… 56789   germany E       johnme…       8 John a… E       johnja…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span>    10 John M… 55555   germany Y       johnme…      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span>    11 John M… 55555   norway  Y       johnme…      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 5 more variables: postcode_tilt &lt;chr&gt;, country_tilt &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   similarity &lt;dbl&gt;, suggest_match &lt;lgl&gt;, accept_match &lt;lgl&gt;, and abbreviated</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   variable names ¹​company_name, ²​postcode, ³​misc_info, ⁴​company_alias,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ⁵​company_name_tilt, ⁶​misc_info_tilt, ⁷​company_alias_tilt</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mirja Hollmann, Linda Delacombaz, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

